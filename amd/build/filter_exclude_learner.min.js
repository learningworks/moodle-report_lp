define(["jquery","core/custom_interaction_events","core/ajax","core/notification","core/str","core/log"],function(a,b,c,d,e,f){var g={LIST_CONTAINER:'[data-container="learners"]',EXCLUDED_LIST_CONTAINER:'[data-container="excluded"]',EXCLUDED_LIST:'[data-list="excluded"]',EXCLUDED_LIST_RESET:'[data-action="excluded-reset"]',ROW:"[data-row]",DESCENDANTS:'[data-filter="exclude-learner"]',USER_ID:"data-learner-id",COURSE_ID:"data-course-id"},h=function(e){var f=this;b.define(e,[b.events.activate]),e.on(b.events.activate,g.DESCENDANTS,function(b,e){var h=a(b.target).closest(g.ROW),i=h.attr(g.USER_ID),j=a(g.LIST_CONTAINER).attr(g.COURSE_ID),k={methodname:"report_lp_filter_exclude_learner_add_learner",args:{courseid:j,userid:i}},l=c.call([k])[0];l.done(function(b){f.data=b;var c=[];(void 0!==b||b.length>0)&&(c=b.map(function(a){return a.fullname})),a(g.EXCLUDED_LIST).text(c.join(", ")),a(g.EXCLUDED_LIST_CONTAINER).removeClass("d-none"),h.addClass("d-none")}),l.fail(d.exception),e.originalEvent.preventDefault()}),e.on(b.events.activate,g.EXCLUDED_LIST_RESET,function(b,e){var h=a(g.EXCLUDED_LIST_CONTAINER),i=h.attr(g.COURSE_ID),j={methodname:"report_lp_filter_exclude_learner_reset",args:{courseid:i}},k=c.call([j])[0];k.done(function(a){f.data=a,document.location.reload()}),k.fail(d.exception),e.originalEvent.preventDefault()})},i=function(b){f.debug("Initialising "+b),b=a(b),h(b)};return{init:i}});