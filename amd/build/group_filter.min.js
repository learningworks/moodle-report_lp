define(["jquery","core/custom_interaction_events","core/ajax","core/notification","core/str","core/log"],function(a,b,c,d,e,f){var g={LIST_CONTAINER:"[data-active-menu]",DESCENDANTS:"[data-filter]",ID_ATTRIBUTE_NAME:"data-group-id",ACTIVE_TEXT:"[data-active-text]"},h=function(e){b.define(e,[b.events.activate]),e.on(b.events.activate,g.DESCENDANTS,function(b,e){var h=this,i=[],j=[],k=a(b.target),l=k.closest(g.LIST_CONTAINER);if(k.hasClass("dropdown-item")){k.toggleClass("active");var m=l.find(".active");m.length&&m.each(function(a,b){var c=b.getAttribute(g.ID_ATTRIBUTE_NAME);j.push(c);var d=b.innerText;i.push(d)});var n=l.parent().find('[data-toggle="dropdown"]'),o=n.find(g.ACTIVE_TEXT);o.length&&(i.length?o.html(i.join(", ")):o.html("Filter groups")),f.debug(j.join());var p={methodname:"report_lp_set_group_filter",args:{courseid:l.attr("data-course-id"),groupids:j.join()}},q=c.call([p])[0];q.done(function(a){h.response=a}).fail(d.exception),e.originalEvent.preventDefault(),window.location.replace(l.attr("data-redirect-url"))}})},i=function(b){f.debug("Initialising filter "+b),b=a(b),h(b)};return{init:i}});